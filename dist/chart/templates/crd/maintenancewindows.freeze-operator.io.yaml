{{- if .Values.crd.enable }}
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
    annotations:
        controller-gen.kubebuilder.io/version: v0.20.0
    name: maintenancewindows.freeze-operator.io
spec:
    group: freeze-operator.io
    names:
        kind: MaintenanceWindow
        listKind: MaintenanceWindowList
        plural: maintenancewindows
        singular: maintenancewindow
    scope: Cluster
    versions:
        - name: v1alpha1
          schema:
            openAPIV3Schema:
                description: MaintenanceWindow is the Schema for the maintenancewindows API
                properties:
                    apiVersion:
                        description: |-
                            APIVersion defines the versioned schema of this representation of an object.
                            Servers should convert recognized schemas to the latest internal value, and
                            may reject unrecognized values.
                            More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                        type: string
                    kind:
                        description: |-
                            Kind is a string value representing the REST resource this object represents.
                            Servers may infer this from the endpoint the client submits requests to.
                            Cannot be updated.
                            In CamelCase.
                            More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                        type: string
                    metadata:
                        type: object
                    spec:
                        description: spec defines the desired state of MaintenanceWindow
                        properties:
                            behavior:
                                description: behavior configures optional side-effects.
                                properties:
                                    suspendCronJobs:
                                        description: suspendCronJobs indicates whether the operator should suspend matching CronJobs while the policy is active.
                                        type: boolean
                                type: object
                            message:
                                description: message configures user-facing denial message data.
                                properties:
                                    contact:
                                        description: contact is a contact point (team, oncall, etc.).
                                        type: string
                                    docsURL:
                                        description: docsURL is a link to documentation.
                                        type: string
                                    reason:
                                        description: reason is a short human-readable description.
                                        type: string
                                type: object
                            mode:
                                description: |-
                                    mode defines how windows are interpreted.
                                    v0.1 supports only DenyOutsideWindows.
                                enum:
                                    - DenyOutsideWindows
                                type: string
                            rules:
                                description: rules define which actions are denied when the policy is active.
                                properties:
                                    deny:
                                        description: deny lists which actions are denied when the policy is active.
                                        items:
                                            description: |-
                                                Action represents an operation category that can be denied/allowed by policies.

                                                Note: UPDATE is mapped into more specific actions like ROLL_OUT / SCALE.
                                            enum:
                                                - CREATE
                                                - DELETE
                                                - ROLL_OUT
                                                - SCALE
                                            type: string
                                        minItems: 1
                                        type: array
                                required:
                                    - deny
                                type: object
                            target:
                                description: target selects namespaces/objects/kinds this policy applies to.
                                properties:
                                    kinds:
                                        description: kinds limits the set of resource kinds the policy applies to.
                                        items:
                                            description: TargetKind represents Kubernetes workload kinds targeted by policies.
                                            enum:
                                                - Deployment
                                                - StatefulSet
                                                - DaemonSet
                                                - CronJob
                                            type: string
                                        minItems: 1
                                        type: array
                                    namespaceSelector:
                                        description: namespaceSelector selects target namespaces by labels.
                                        properties:
                                            matchExpressions:
                                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                                items:
                                                    description: |-
                                                        A label selector requirement is a selector that contains values, a key, and an operator that
                                                        relates the key and values.
                                                    properties:
                                                        key:
                                                            description: key is the label key that the selector applies to.
                                                            type: string
                                                        operator:
                                                            description: |-
                                                                operator represents a key's relationship to a set of values.
                                                                Valid operators are In, NotIn, Exists and DoesNotExist.
                                                            type: string
                                                        values:
                                                            description: |-
                                                                values is an array of string values. If the operator is In or NotIn,
                                                                the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                                                the values array must be empty. This array is replaced during a strategic
                                                                merge patch.
                                                            items:
                                                                type: string
                                                            type: array
                                                            x-kubernetes-list-type: atomic
                                                    required:
                                                        - key
                                                        - operator
                                                    type: object
                                                type: array
                                                x-kubernetes-list-type: atomic
                                            matchLabels:
                                                additionalProperties:
                                                    type: string
                                                description: |-
                                                    matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                                    map is equivalent to an element of matchExpressions, whose key field is "key", the
                                                    operator is "In", and the values array contains only "value". The requirements are ANDed.
                                                type: object
                                        type: object
                                        x-kubernetes-map-type: atomic
                                    objectSelector:
                                        description: objectSelector selects target objects by labels.
                                        properties:
                                            matchExpressions:
                                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                                items:
                                                    description: |-
                                                        A label selector requirement is a selector that contains values, a key, and an operator that
                                                        relates the key and values.
                                                    properties:
                                                        key:
                                                            description: key is the label key that the selector applies to.
                                                            type: string
                                                        operator:
                                                            description: |-
                                                                operator represents a key's relationship to a set of values.
                                                                Valid operators are In, NotIn, Exists and DoesNotExist.
                                                            type: string
                                                        values:
                                                            description: |-
                                                                values is an array of string values. If the operator is In or NotIn,
                                                                the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                                                the values array must be empty. This array is replaced during a strategic
                                                                merge patch.
                                                            items:
                                                                type: string
                                                            type: array
                                                            x-kubernetes-list-type: atomic
                                                    required:
                                                        - key
                                                        - operator
                                                    type: object
                                                type: array
                                                x-kubernetes-list-type: atomic
                                            matchLabels:
                                                additionalProperties:
                                                    type: string
                                                description: |-
                                                    matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                                    map is equivalent to an element of matchExpressions, whose key field is "key", the
                                                    operator is "In", and the values array contains only "value". The requirements are ANDed.
                                                type: object
                                        type: object
                                        x-kubernetes-map-type: atomic
                                required:
                                    - kinds
                                type: object
                            timezone:
                                description: timezone is an IANA timezone name.
                                minLength: 1
                                type: string
                            windows:
                                description: windows defines allowed maintenance intervals.
                                items:
                                    description: MaintenanceWindowWindowSpec defines a recurring maintenance window.
                                    properties:
                                        duration:
                                            description: duration is how long the window lasts.
                                            type: string
                                        name:
                                            description: name is a human-readable identifier.
                                            minLength: 1
                                            type: string
                                        schedule:
                                            description: schedule is a cron expression.
                                            minLength: 1
                                            type: string
                                    required:
                                        - duration
                                        - name
                                        - schedule
                                    type: object
                                minItems: 1
                                type: array
                        required:
                            - mode
                            - rules
                            - target
                            - timezone
                            - windows
                        type: object
                    status:
                        description: status defines the observed state of MaintenanceWindow
                        properties:
                            active:
                                description: active indicates whether the policy currently enforces denies.
                                type: boolean
                            activeWindow:
                                description: activeWindow, if active, describes the current window.
                                properties:
                                    endTime:
                                        description: endTime is the end of the interval.
                                        format: date-time
                                        type: string
                                    name:
                                        description: name is the name of the window.
                                        type: string
                                    startTime:
                                        description: startTime is the start of the interval.
                                        format: date-time
                                        type: string
                                type: object
                            conditions:
                                description: |-
                                    conditions represent the current state of the MaintenanceWindow resource.
                                    Each condition has a unique type and reflects the status of a specific aspect of the resource.

                                    Standard condition types include:
                                    - "Available": the resource is fully functional
                                    - "Progressing": the resource is being created or updated
                                    - "Degraded": the resource failed to reach or maintain its desired state

                                    The status of each condition is one of True, False, or Unknown.
                                items:
                                    description: Condition contains details for one aspect of the current state of this API Resource.
                                    properties:
                                        lastTransitionTime:
                                            description: |-
                                                lastTransitionTime is the last time the condition transitioned from one status to another.
                                                This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                                            format: date-time
                                            type: string
                                        message:
                                            description: |-
                                                message is a human readable message indicating details about the transition.
                                                This may be an empty string.
                                            maxLength: 32768
                                            type: string
                                        observedGeneration:
                                            description: |-
                                                observedGeneration represents the .metadata.generation that the condition was set based upon.
                                                For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                                                with respect to the current state of the instance.
                                            format: int64
                                            minimum: 0
                                            type: integer
                                        reason:
                                            description: |-
                                                reason contains a programmatic identifier indicating the reason for the condition's last transition.
                                                Producers of specific condition types may define expected values and meanings for this field,
                                                and whether the values are considered a guaranteed API.
                                                The value should be a CamelCase string.
                                                This field may not be empty.
                                            maxLength: 1024
                                            minLength: 1
                                            pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                                            type: string
                                        status:
                                            description: status of the condition, one of True, False, Unknown.
                                            enum:
                                                - "True"
                                                - "False"
                                                - Unknown
                                            type: string
                                        type:
                                            description: type of condition in CamelCase or in foo.example.com/CamelCase.
                                            maxLength: 316
                                            pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                                            type: string
                                    required:
                                        - lastTransitionTime
                                        - message
                                        - reason
                                        - status
                                        - type
                                    type: object
                                type: array
                                x-kubernetes-list-map-keys:
                                    - type
                                x-kubernetes-list-type: map
                            nextWindow:
                                description: nextWindow describes the next upcoming window.
                                properties:
                                    endTime:
                                        description: endTime is the end of the interval.
                                        format: date-time
                                        type: string
                                    name:
                                        description: name is the name of the window.
                                        type: string
                                    startTime:
                                        description: startTime is the start of the interval.
                                        format: date-time
                                        type: string
                                type: object
                            observedGeneration:
                                description: observedGeneration is the last observed generation.
                                format: int64
                                type: integer
                        type: object
                required:
                    - spec
                type: object
          served: true
          storage: true
          subresources:
            status: {}
{{- end }}
